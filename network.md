# 计算机网络自顶向下方法

#### 协议
> 在两个或多个通信实体之间交换报文的格式和次序，以及对某报文或其他时间传输和接听采取的动作。

*时分复用时，端到端电路传输时间与链路数量无关*  

不可以给某一传输多分配几个时隙，单个帧中可以传输更多的数据。

cookie可以在http之上建立一个用户会话层，允许服务器在用户与应用程序会话的过程中标识该用户。

#### 减少响应时间
1. 在机构网络中建立高速web缓存器
2. 使用条件get

### 在浏览器中输入一个url，背后发生了哪些事
1. 浏览器解析URI。如果是搜索内容，会自动URL编码并拼接为默认搜索引擎的params。如果URI，添加http和默认端口号80。如果原本有页面，出发当前页面的beforeunload和unload事件，同事浏览器便签进入loading图标状态。
2. 构建请求。
3. DNS解析。
> [透过 Chrome 深入理解浏览器导航过程](https://juejin.cn/post/7018053604548280334#13b6cbdf)

### 运输层和网络层
运输层提供应用进程间的逻辑通信，网络层提供主机间的逻辑通信。
网络层不保证报文的交付，报文段的按序交付，报文段数据的完整性，因此IP被称为不可靠服务。

TCP将两个端系统间不可靠的IP服务转换成一种进程间的可靠数据传输服务。
运输层最低喜爱难度是必须提供一种复用/分解服务，以便在网络层和正确的应用级进程之间传递数据，即UDP协议所做的事。

运输层不直接把接收到的数据交付给进程，而是其中的一个套接字。一个进程可对应多个套接字，每个套接字都有一个唯一的标识符，udp协议使用二元组(目的iP,目的端口号)标识；tcp协议使用四元组(源ip,源端口号,目的ip,目的端口号)标识，目的ip和目的端口号相同的报文段会区分源ip和端口号，分别定向到不同的套接字，除了最初创建连接的请求。
* TCP是一种有状态、记录状态的协议？ *
> 因为tcp根据源ip和源端口号传递到之前的套接字，还在同一个连接上
* TCP会根据源端口和源ip建立不同的套接字，分配不同的端口号，可是总共端口号只有65535个，大型服务器怎么建立多个连接？套接字一定会有唯一的端口号吗？*
> 错误。TCP中，套接字的标识是四元组（源ip，源端口号，目的ip，目的端口号）。所以服务器每个http连接的套接字端口号应该是相同的，是通过四元组来区分http连接的。

* 进程，端口，套接字的关系 *
> 理论上，Web服务器会为每条连接生成一个新进程，每个进程都有自己的一个套接字。实际上，连接套接字和进程间并非一一对应。当今的高性能web服务器通常只使用一个进程，为每个新连接创建一个新线程。

### 协议的对比

| 协议      | 连接状态 | 首部大小  |
| ----------- | ----------- |----------- |
| HTTP      | 无连接状态。两端不维护连接状态，两次请求无相关联系。cookie使得服务器中保存一个用户的登录状态。       | 20字节 |
| TCP   | 无连接状态  | 20字节 |
| UDP   | TCP在端系统中维持连接状态，包括接受和发送缓存、拥塞控制参数、序号与确认号的参数，是现在TCP的可靠数据传输和拥塞控制。  |8字节|

